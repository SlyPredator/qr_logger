<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>QR Logger</title>
</head>
<body>
  <h2>Logging your scan...</h2>
  <div id="status"></div>

  <script>
    function getQueryParam(param) {
      let urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(param);
    }

    async function main() {
      const name = getQueryParam('name') || 'Unknown';
      const postData = { name: name };

      // Replace below with your Google Apps Script Web App URL
      const endpoint = 'https://script.google.com/macros/s/AKfycbwBHmyG3YS_RuXJrxhkrFqYvO-Y_eyMF_X-X-lJQc6_DaaC7flQw3QS7YVqB9pUu6Ry/exec';

      try {
        let response = await fetch(endpoint, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(postData),
        });
        if (response.ok) {
          document.getElementById('status').innerText = 'Logged! You may close this tab.';
        } else {
          document.getElementById('status').innerText =
            'Logging failed. HTTP: ' + response.status;
        }
      } catch (e) {
        document.getElementById('status').innerText = 'Network error: ' + e;
      }
    }

    main();
  </script>
</body>
</html>
